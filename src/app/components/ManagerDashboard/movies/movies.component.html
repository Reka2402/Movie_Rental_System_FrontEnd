<div class="container mt-5">
  <div class="card shadow p-4 mb-5 bg-white rounded">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <input
        type="text"
        class="form-control w-25"
        placeholder="Search Movies..."
        id="searchInput"
        [(ngModel)]="searchText"
        style="border: 1px solid #ccc; border-radius: 8px; background-color: #f8f8f8;"
      />
      <button
        class="btn btn-dark px-4 py-2"
        (click)="openAddMoviePopup()"
        style="border-radius: 8px; background-color: black; color: white; border: none; transition: 0.3s;"
        onmouseover="this.style.backgroundColor='gray'"
        onmouseout="this.style.backgroundColor='black'"
      >
        + Add Movie
      </button>
    </div>
    <div class="table-responsive">
      <table class="table table-hover align-middle table-bordered">
        <thead class="table-dark">
          <tr style="background-color: #2e2e2e; color: white;">
            <th>Image</th>
            <th>Movie</th>
            <th>Genre</th>
            <th>Director</th>
            <th>Release Date</th>
            <th>Price</th>
            <th>Description</th>
            <th>Total Copies</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let movie of movies" style="background-color: #f9f9f9;">
            <td>
              <img
                *ngIf="movie.imageUrl"
                [src]="movie.imageUrl"
                alt="Movie Image"
                width="50"
                height="50"
                class="rounded shadow-sm"
              />
              <img
                *ngIf="!movie.imageUrl"
                src="/movies/movie12.png"
                alt="Default Image"
                width="50"
                height="50"
                class="rounded shadow-sm"
              />
            </td>
            <td>{{ movie.movieName }}</td>
            <td>{{ movie.genre.name }}</td>
            <td>{{ movie.director.name }}</td>
            <td>{{ movie.releaseDate | date }}</td>
            <td>{{ movie.price | currency }}</td>
            <td>{{ movie.description }}</td>
            <td>{{ movie.totalCopies }}</td>
            <td>
              <button
                class="btn btn-outline-dark btn-sm me-2"
                (click)="onEdit(movie.id)"
                style="border-radius: 6px;"
              >
                <i class="bi bi-pencil-square"></i>
              </button>
              <button
                class="btn btn-outline-danger btn-sm"
                (click)="onDelete(movie.id)"
                style="border-radius: 6px;"
              >
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Add-Movie-Popup -->
<div
  *ngIf="isAddMoviePopupOpen"
  class="popup-overlay"
  style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center; z-index: 1000;"
>
  <div
    class="popup-content card shadow-lg p-4 mb-5 bg-white rounded"
    style="width: 50%; max-width: 600px;"
  >
    <form [formGroup]="movieForm">
      <h4 class="mb-4 text-dark text-center">Movie Details</h4>
      <div class="row">
        <div class="col-lg-6 mb-3">
          <label for="movieName" class="form-label fw-bold">Title</label>
          <input
            type="text"
            class="form-control border border-light rounded"
            id="movieName"
            placeholder="Enter movie title"
            formControlName="movieName"
          />
        </div>
        <div class="col-lg-6 mb-3">
          <label for="genreName" class="form-label fw-bold">Genre</label>
          <input
            type="text"
            class="form-control border border-light rounded"
            id="genreName"
            placeholder="Enter movie genre"
            formControlName="genreName"
          />
        </div>
        <div class="col-lg-6 mb-3">
          <label for="directorName" class="form-label fw-bold">Director</label>
          <input
            type="text"
            class="form-control border border-light rounded"
            id="directorName"
            placeholder="Enter director's name"
            formControlName="directorName"
          />
        </div>
        <div class="col-lg-6 mb-3">
          <label for="releaseDate" class="form-label fw-bold">Release Date</label>
          <input
            type="date"
            class="form-control border border-light rounded"
            id="releaseDate"
            formControlName="releaseDate"
          />
        </div>
        <div class="col-lg-6 mb-3">
          <label for="price" class="form-label fw-bold">Price</label>
          <input
            type="number"
            class="form-control border border-light rounded"
            id="price"
            placeholder="Enter price"
            formControlName="price"
          />
        </div>
        <div class="col-lg-6 mb-3">
          <label for="totalCopies" class="form-label fw-bold">Total Copies</label>
          <input
            type="number"
            class="form-control border border-light rounded"
            id="totalCopies"
            placeholder="Enter total copies"
            formControlName="totalCopies"
          />
        </div>
        <div class="col-12 mb-3">
          <label for="description" class="form-label fw-bold">Description</label>
          <textarea
            class="form-control border border-light rounded"
            id="description"
            rows="3"
            placeholder="Enter movie description"
            formControlName="description"
          ></textarea>
        </div>
        <div class="col-12 mb-3">
          <label for="imageUrl" class="form-label fw-bold">Image URL</label>
          <input
            type="text"
            class="form-control border border-light rounded"
            id="imageUrl"
            placeholder="Enter image URL (optional)"
            formControlName="imageUrl"
          />
        </div>
      </div>
      <div class="d-flex justify-content-between mt-3">
        <button
          type="submit"
          class="btn btn-dark px-4 py-2"
          [disabled]="movieForm.invalid"
          (click)="onSubmit()"
          style="border-radius: 8px;"
        >
          Submit
        </button>
        <button
          type="button"
          class="btn btn-secondary px-4 py-2"
          (click)="cancel()"
          style="border-radius: 8px;"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
